-- MySQL Script generated by MySQL Workbench
-- Tue Jun 15 16:36:57 2021
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`usuario`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`usuario` (
  `idUsuario` INT NOT NULL AUTO_INCREMENT,
  `usario` VARCHAR(45) NULL,
  `nombres` VARCHAR(50) NULL,
  `apellidos` VARCHAR(50) NULL,
  `rol` CHAR(1) NULL,
  `password` VARCHAR(40) NULL,
  PRIMARY KEY (`idUsuario`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`estudiante`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`estudiante` (
  `idestudiante` VARCHAR(8) NOT NULL,
  `nombre` VARCHAR(45) NULL,
  `apellidos` VARCHAR(45) NULL,
  PRIMARY KEY (`idestudiante`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`nivel`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`nivel` (
  `idnivel` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NULL,
  PRIMARY KEY (`idnivel`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`grado`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`grado` (
  `idgrado` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NULL,
  `seccion` VARCHAR(45) NULL,
  `nivel_idnivel` INT NOT NULL,
  PRIMARY KEY (`idgrado`, `nivel_idnivel`),
  INDEX `fk_grado_nivel1_idx` (`nivel_idnivel` ASC) VISIBLE,
  CONSTRAINT `fk_grado_nivel1`
    FOREIGN KEY (`nivel_idnivel`)
    REFERENCES `mydb`.`nivel` (`idnivel`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`materia`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`materia` (
  `idmateria` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NULL,
  PRIMARY KEY (`idmateria`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`proyecto`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`proyecto` (
  `idproyecto` INT NOT NULL AUTO_INCREMENT,
  `nombreProyecto` VARCHAR(45) NULL,
  `descripcion` MEDIUMTEXT NULL,
  `grado_idgrado` INT NOT NULL,
  `materia_idmateria` INT NOT NULL,
  PRIMARY KEY (`idproyecto`, `grado_idgrado`, `materia_idmateria`),
  INDEX `fk_proyecto_grado1_idx` (`grado_idgrado` ASC) VISIBLE,
  INDEX `fk_proyecto_materia1_idx` (`materia_idmateria` ASC) VISIBLE,
  CONSTRAINT `fk_proyecto_grado1`
    FOREIGN KEY (`grado_idgrado`)
    REFERENCES `mydb`.`grado` (`idgrado`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_proyecto_materia1`
    FOREIGN KEY (`materia_idmateria`)
    REFERENCES `mydb`.`materia` (`idmateria`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`equipo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`equipo` (
  `idequipo` INT NOT NULL AUTO_INCREMENT,
  `estudiante_idestudiante` VARCHAR(8) NOT NULL,
  `proyecto_idproyecto` INT NOT NULL,
  PRIMARY KEY (`idequipo`, `estudiante_idestudiante`, `proyecto_idproyecto`),
  INDEX `fk_equipo_estudiante_idx` (`estudiante_idestudiante` ASC) VISIBLE,
  INDEX `fk_equipo_proyecto1_idx` (`proyecto_idproyecto` ASC) VISIBLE,
  CONSTRAINT `fk_equipo_estudiante`
    FOREIGN KEY (`estudiante_idestudiante`)
    REFERENCES `mydb`.`estudiante` (`idestudiante`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_equipo_proyecto1`
    FOREIGN KEY (`proyecto_idproyecto`)
    REFERENCES `mydb`.`proyecto` (`idproyecto`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`rubrica`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`rubrica` (
  `idrubrica` VARCHAR(15) NOT NULL,
  `nombre` VARCHAR(45) NULL,
  `materia_idmateria` INT NOT NULL,
  `nivel_idnivel` INT NOT NULL,
  PRIMARY KEY (`idrubrica`, `materia_idmateria`, `nivel_idnivel`),
  INDEX `fk_rubrica_materia1_idx` (`materia_idmateria` ASC) VISIBLE,
  INDEX `fk_rubrica_nivel1_idx` (`nivel_idnivel` ASC) VISIBLE,
  CONSTRAINT `fk_rubrica_materia1`
    FOREIGN KEY (`materia_idmateria`)
    REFERENCES `mydb`.`materia` (`idmateria`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_rubrica_nivel1`
    FOREIGN KEY (`nivel_idnivel`)
    REFERENCES `mydb`.`nivel` (`idnivel`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`criterios`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`criterios` (
  `idcriterios` INT NOT NULL AUTO_INCREMENT,
  `titulo` VARCHAR(45) NULL,
  `descripcion` LONGTEXT NULL,
  `puntaje` INT NULL,
  `rubrica_idrubrica` VARCHAR(15) NOT NULL,
  PRIMARY KEY (`idcriterios`, `rubrica_idrubrica`),
  INDEX `fk_criterios_rubrica1_idx` (`rubrica_idrubrica` ASC) VISIBLE,
  CONSTRAINT `fk_criterios_rubrica1`
    FOREIGN KEY (`rubrica_idrubrica`)
    REFERENCES `mydb`.`rubrica` (`idrubrica`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`asignacionJ`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`asignacionJ` (
  `idasignacionJ` INT NOT NULL AUTO_INCREMENT,
  `usuario_idUsuario` INT NOT NULL,
  `materia_idmateria` INT NOT NULL,
  `grado_idgrado` INT NOT NULL,
  PRIMARY KEY (`idasignacionJ`, `usuario_idUsuario`, `materia_idmateria`, `grado_idgrado`),
  INDEX `fk_asignacionJ_usuario1_idx` (`usuario_idUsuario` ASC) VISIBLE,
  INDEX `fk_asignacionJ_materia1_idx` (`materia_idmateria` ASC) VISIBLE,
  INDEX `fk_asignacionJ_grado1_idx` (`grado_idgrado` ASC) VISIBLE,
  CONSTRAINT `fk_asignacionJ_usuario1`
    FOREIGN KEY (`usuario_idUsuario`)
    REFERENCES `mydb`.`usuario` (`idUsuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_asignacionJ_materia1`
    FOREIGN KEY (`materia_idmateria`)
    REFERENCES `mydb`.`materia` (`idmateria`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_asignacionJ_grado1`
    FOREIGN KEY (`grado_idgrado`)
    REFERENCES `mydb`.`grado` (`idgrado`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`puntos`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`puntos` (
  `idpuntos` INT NOT NULL AUTO_INCREMENT,
  `puntos` INT NULL,
  `criterios_idcriterios` INT NOT NULL,
  PRIMARY KEY (`idpuntos`, `criterios_idcriterios`),
  INDEX `fk_puntos_criterios1_idx` (`criterios_idcriterios` ASC) VISIBLE,
  CONSTRAINT `fk_puntos_criterios1`
    FOREIGN KEY (`criterios_idcriterios`)
    REFERENCES `mydb`.`criterios` (`idcriterios`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`puntaje`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`puntaje` (
  `idpuntaje` INT NOT NULL AUTO_INCREMENT,
  `proyecto_idproyecto` INT NOT NULL,
  `usuario_idUsuario` INT NOT NULL,
  `puntaje` DECIMAL(3) NULL,
  `puntos_idpuntos` INT NOT NULL,
  PRIMARY KEY (`idpuntaje`, `proyecto_idproyecto`, `usuario_idUsuario`, `puntos_idpuntos`),
  INDEX `fk_puntaje_proyecto1_idx` (`proyecto_idproyecto` ASC) VISIBLE,
  INDEX `fk_puntaje_usuario1_idx` (`usuario_idUsuario` ASC) VISIBLE,
  INDEX `fk_puntaje_puntos1_idx` (`puntos_idpuntos` ASC) VISIBLE,
  CONSTRAINT `fk_puntaje_proyecto1`
    FOREIGN KEY (`proyecto_idproyecto`)
    REFERENCES `mydb`.`proyecto` (`idproyecto`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_puntaje_usuario1`
    FOREIGN KEY (`usuario_idUsuario`)
    REFERENCES `mydb`.`usuario` (`idUsuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_puntaje_puntos1`
    FOREIGN KEY (`puntos_idpuntos`)
    REFERENCES `mydb`.`puntos` (`idpuntos`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


-- -----------------------------------------------------
-- Table `mydb`.`Ranking`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Ranking` (
  `idRanking` INT NOT NULL AUTO_INCREMENT,
  `proyecto_idproyecto` INT NOT NULL,
  `proyecto_grado_idgrado` INT NOT NULL,
  `proyecto_materia_idmateria` INT NOT NULL,
  `puntaje_idpuntaje` INT NOT NULL,
  PRIMARY KEY (`idRanking`, `proyecto_idproyecto`, `proyecto_grado_idgrado`, `proyecto_materia_idmateria`, `puntaje_idpuntaje`),
  INDEX `fk_Ranking_proyecto1_idx` (`proyecto_idproyecto` ASC, `proyecto_grado_idgrado` ASC, `proyecto_materia_idmateria` ASC) VISIBLE,
  INDEX `fk_Ranking_puntaje1_idx` (`puntaje_idpuntaje` ASC) VISIBLE,
  CONSTRAINT `fk_Ranking_proyecto1`
    FOREIGN KEY (`proyecto_idproyecto` , `proyecto_grado_idgrado` , `proyecto_materia_idmateria`)
    REFERENCES `mydb`.`proyecto` (`idproyecto` , `grado_idgrado` , `materia_idmateria`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Ranking_puntaje1`
    FOREIGN KEY (`puntaje_idpuntaje`)
    REFERENCES `mydb`.`puntaje` (`idpuntaje`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_spanish2_ci;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
